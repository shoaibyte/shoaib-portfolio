---
// src/pages/index.astro
import { getCollection } from 'astro:content';
import PortfolioLayout from '../layouts/PortfolioLayout.astro';

// Get latest blog posts and projects
const blogPosts = await getCollection('blog', ({ data }) => {
	return !data.draft;
});

const projects = await getCollection('projects');

// Sort by publish date (newest first)
const latestBlogPosts = blogPosts
	.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
	.slice(0, 4);

const latestProjects = projects
	.sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
	.slice(0, 4);
---

<PortfolioLayout
	title="Shoaib - Software Engineer & Creator"
	description="Software Engineer passionate about building scalable web applications and elegant user experiences. I specialize in React, TypeScript, and modern web technologies."
>
	<!-- Hero Section -->
	<section class="hero fade-in">
		<div class="hero-content">
			<h1>Hey, I'm Shoaib!</h1>
			<p class="hero-description">
				I'm a software engineer, open-source creator, and passionate developer.
				I've been building scalable distributed systems since 2022 and
				<a href="/blog" class="hero-highlight">writing on this blog</a> for over two years!
			</p>
			<p class="hero-note">
				Everything on this site is written by me, not AI.
			</p>
			<div class="hero-actions">
				<a href="/about" class="btn btn-primary">
					<span>üë§</span>
					About Me
				</a>
				<a href="/contact" class="btn btn-secondary">
					<span>üìß</span>
					Get in Touch
				</a>
			</div>
		</div>

		<div class="hero-avatar fade-in fade-in-delay-1">
			<img
				src="public/profile.jpeg?w=400&h=400&fit=crop&crop=face"
				alt="Shoaib"
				class="avatar"
			>
		</div>
	</section>

	<!-- Content Grid -->
	<div class="content-grid">
		<!-- Notes Section -->
		<section class="content-section fade-in fade-in-delay-2">
			<div class="section-header">
				<h2 class="section-title">Latest Posts</h2>
				<a href="/blog" class="see-all">See All</a>
			</div>
			<p class="section-subtitle">Technical articles, tutorials, and insights.</p>

			<div class="post-list">
				{latestBlogPosts.map((post) => (
					<a href={`/blog/${post.slug}`} class="post-card">
						<h3 class="post-title">{post.data.title}</h3>
						<time class="post-date">
							{post.data.publishDate.toLocaleDateString('en-US', {
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							})}
						</time>
						{post.data.description && (
							<p class="post-description">{post.data.description}</p>
						)}
						{post.data.tags && post.data.tags.length > 0 && (
							<div class="post-tags">
								{post.data.tags.slice(0, 3).map((tag) => (
									<span class="tag">{tag}</span>
								))}
							</div>
						)}
					</a>
				))}
			</div>
		</section>

		<!-- Projects Section -->
		<section class="content-section fade-in fade-in-delay-3">
			<div class="section-header">
				<h2 class="section-title">Featured Projects</h2>
				<a href="/projects" class="see-all">See All</a>
			</div>
			<p class="section-subtitle">Things I've built and open-sourced.</p>

			<div class="post-list">
				{latestProjects.map((project) => (
					<a href={`/projects/${project.slug}`} class="post-card project-card">
						<div class="project-header">
							<h3 class="post-title">{project.data.title}</h3>
							<div class="project-links">
								{project.data.github && (
									<a
										href={project.data.github}
										class="project-link"
										target="_blank"
										rel="noopener noreferrer"
										aria-label="GitHub"
										onclick="event.stopPropagation()"
									>
										üêô
									</a>
								)}
								{project.data.demo && (
									<a
										href={project.data.demo}
										class="project-link"
										target="_blank"
										rel="noopener noreferrer"
										aria-label="Live Demo"
										onclick="event.stopPropagation()"
									>
										üöÄ
									</a>
								)}
							</div>
						</div>
						<time class="post-date">
							{project.data.publishDate.toLocaleDateString('en-US', {
								year: 'numeric',
								month: 'long'
							})}
						</time>
						{project.data.description && (
							<p class="post-description">{project.data.description}</p>
						)}
						{project.data.status && (
							<span class={`status-badge status-${project.data.status}`}>
                {project.data.status}
              </span>
						)}
						{project.data.tags && project.data.tags.length > 0 && (
							<div class="post-tags">
								{project.data.tags.slice(0, 3).map((tag) => (
									<span class="tag">{tag}</span>
								))}
							</div>
						)}
					</a>
				))}
			</div>
		</section>
	</div>
</PortfolioLayout>

<style>
	/* Hero Section */
	.hero {
		display: grid;
		grid-template-columns: 1fr 200px;
		gap: var(--space-12);
		align-items: center;
		margin-bottom: var(--space-16);
	}

	.hero-content h1 {
		font-size: 3rem;
		font-weight: 800;
		line-height: 1.1;
		margin-bottom: var(--space-6);
		color: var(--color-text);
	}

	.hero-description {
		font-size: 1.125rem;
		color: var(--color-text-secondary);
		line-height: 1.7;
		margin-bottom: var(--space-2);
	}

	.hero-highlight {
		color: var(--color-primary);
		text-decoration: none;
		font-weight: 600;
	}

	.hero-highlight:hover {
		text-decoration: underline;
	}

	.hero-note {
		font-size: 1rem;
		color: var(--color-text-secondary);
		margin-bottom: var(--space-8);
	}

	.hero-actions {
		display: flex;
		gap: var(--space-4);
	}

	.btn {
		display: inline-flex;
		align-items: center;
		gap: var(--space-2);
		padding: var(--space-3) var(--space-5);
		border: none;
		border-radius: var(--radius-lg);
		font-family: inherit;
		font-size: 0.875rem;
		font-weight: 500;
		text-decoration: none;
		cursor: pointer;
		transition: all var(--transition-fast);
	}

	.btn-primary {
		background: var(--color-primary);
		color: white;
	}

	.btn-primary:hover {
		background: var(--color-primary-dark);
		transform: translateY(-1px);
	}

	.btn-secondary {
		background: var(--color-bg-secondary);
		color: var(--color-text);
		border: 1px solid var(--color-border);
	}

	.btn-secondary:hover {
		background: var(--color-bg-tertiary);
		transform: translateY(-1px);
	}

	.hero-avatar {
		position: relative;
	}

	.avatar {
		width: 200px;
		height: 200px;
		border-radius: 50%;
		object-fit: cover;
		border: 4px solid var(--color-border);
		transition: all var(--transition);
	}

	.avatar:hover {
		transform: scale(1.05);
	}

	/* Content Sections */
	.content-grid {
		display: grid;
		grid-template-columns: 1fr 1fr;
		gap: var(--space-12);
	}

	.content-section {
		margin-bottom: var(--space-8);
	}

	.section-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: var(--space-6);
	}

	.section-title {
		font-size: 1.875rem;
		font-weight: 700;
		color: var(--color-text);
	}

	.section-subtitle {
		font-size: 1rem;
		color: var(--color-text-secondary);
		margin-bottom: var(--space-6);
	}

	.see-all {
		color: var(--color-text-secondary);
		text-decoration: none;
		font-size: 0.875rem;
		font-weight: 500;
		transition: color var(--transition-fast);
	}

	.see-all:hover {
		color: var(--color-primary);
	}

	/* Post Cards */
	.post-list {
		display: flex;
		flex-direction: column;
		gap: var(--space-4);
	}

	.post-card {
		display: block;
		text-decoration: none;
		padding: var(--space-4);
		border-radius: var(--radius-lg);
		transition: all var(--transition-fast);
		border: 1px solid transparent;
	}

	.post-card:hover {
		background: var(--color-bg-secondary);
		border-color: var(--color-border);
		transform: translateY(-2px);
	}

	.post-title {
		font-size: 1.125rem;
		font-weight: 600;
		color: var(--color-primary);
		margin-bottom: var(--space-2);
		line-height: 1.4;
	}

	.post-date {
		font-size: 0.875rem;
		color: var(--color-text-secondary);
		margin-bottom: var(--space-2);
	}

	.post-description {
		font-size: 0.875rem;
		color: var(--color-text-secondary);
		line-height: 1.5;
		margin-bottom: var(--space-3);
	}

	.post-tags {
		display: flex;
		gap: var(--space-2);
		flex-wrap: wrap;
	}

	.tag {
		background: var(--color-bg-tertiary);
		color: var(--color-text-secondary);
		padding: var(--space-1) var(--space-2);
		border-radius: var(--radius);
		font-size: 0.75rem;
		font-weight: 500;
	}

	/* Project Cards */
	.project-card .project-header {
		display: flex;
		justify-content: space-between;
		align-items: flex-start;
		margin-bottom: var(--space-2);
	}

	.project-links {
		display: flex;
		gap: var(--space-2);
	}

	.project-link {
		font-size: 1rem;
		text-decoration: none;
		opacity: 0.7;
		transition: opacity var(--transition-fast);
	}

	.project-link:hover {
		opacity: 1;
	}

	.status-badge {
		display: inline-block;
		padding: var(--space-1) var(--space-2);
		border-radius: var(--radius);
		font-size: 0.75rem;
		font-weight: 500;
		text-transform: capitalize;
		margin-bottom: var(--space-2);
	}

	.status-completed {
		background: rgba(16, 185, 129, 0.1);
		color: var(--color-accent-green);
	}

	.status-in-progress {
		background: rgba(245, 158, 11, 0.1);
		color: var(--color-accent-orange);
	}

	.status-planned {
		background: rgba(139, 92, 246, 0.1);
		color: var(--color-accent-purple);
	}

	/* Responsive Design */
	@media (max-width: 1200px) {
		.content-grid {
			grid-template-columns: 1fr;
			gap: var(--space-8);
		}
	}

	@media (max-width: 1024px) {
		.hero {
			grid-template-columns: 1fr;
			text-align: center;
			gap: var(--space-8);
		}

		.avatar {
			width: 150px;
			height: 150px;
		}
	}

	@media (max-width: 768px) {
		.hero-content h1 {
			font-size: 2.25rem;
		}

		.hero-actions {
			flex-direction: column;
			align-items: center;
		}

		.btn {
			width: 100%;
			max-width: 200px;
			justify-content: center;
		}

		.section-title {
			font-size: 1.5rem;
		}

		.project-card .project-header {
			flex-direction: column;
			gap: var(--space-2);
		}

		.project-links {
			align-self: flex-start;
		}
	}
</style>