---
import { getCollection } from 'astro:content';
import PortfolioLayout from '../../layouts/PortfolioLayout.astro';

const posts = (await getCollection('blog', ({ data }) => !data.draft))
    .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf());
---

<PortfolioLayout title="Blog" description="Technical articles, tutorials, and notes.">
    <section class="grid">
        {posts.map(({data, slug }) => (
                <article class="card">
                    <a href={`/blog/${slug}/`} class="card-link">
                        <h3 class="card-title">{data.title}</h3>
                        <p class="card-desc">{data.description}</p>
                        <div class="meta">
                            <time datetime={data.publishDate.toISOString()}>
                                {data.publishDate.toDateString()}
                            </time>
                            {data.tags?.length ? <ul class="tags">
                                {data.tags.map(t => <li>{t}</li>)}
                            </ul> : null}
                        </div>
                    </a>
                </article>
        ))}
    </section>
</PortfolioLayout>

<style>
    .grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--space-6)}
    @media(max-width:900px){.grid{grid-template-columns:1fr}}
    .card {
        padding: var(--space-6);
        border: 1px solid var(--color-border);
        border-radius: 16px;
        transition: transform .15s ease, box-shadow .15s ease;
    }
    .card:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.15)}
    .card-title{margin:0 0 var(--space-2);font-size:1.1rem}
    .card-desc{opacity:.9;margin:0 0 var(--space-3)}
    .meta{display:flex;gap:var(--space-4);align-items:center;flex-wrap:wrap;font-size:.9rem;opacity:.8}
    .tags{display:flex;gap:.5rem;list-style:none;margin:0;padding:0}
    .tags li{padding:.2rem .5rem;border:1px solid var(--color-border);border-radius:999px}
    .card-link{text-decoration:none;color:inherit;display:block}
</style>
